<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html dir="rtl" lang="he">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×”×“×¤×¡×ª ×¤×œ×™×™×¨</title>
    <style type="text/css">
        html {
            font-family: 'David', Calibri, Arial, Helvetica, sans-serif;
            font-size: 11pt;
            background-color: white;
            direction: rtl;
            margin: 0;
            padding: 0;
        }

        body {
            direction: rtl;
            margin: 0;
            padding: 0;
        }

        table {
            direction: rtl
        }

        a.comment-indicator:hover+div.comment {
            background: #ffd;
            position: absolute;
            display: block;
            border: 1px solid black;
            padding: 0.5em
        }

        a.comment-indicator {
            background: red;
            display: inline-block;
            border: 1px solid black;
            width: 0.5em;
            height: 0.5em
        }

        div.comment {
            display: none
        }

        table {
            border-collapse: collapse;
            margin: 0;
            padding: 0;
        }
        
        table td,
        table th {
            margin: 0;
            padding: 0;
        }

        .gridlines td {
            border: none
        }

        .gridlines th {
            border: none
        }

        .b {
            text-align: center
        }

        .e {
            text-align: center
        }

        .f {
            text-align: right
        }

        .inlineStr {
            text-align: left
        }

        .n {
            text-align: right
        }

        .s {
            text-align: left
        }

        td.style0 {
            vertical-align: bottom;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 11pt;
            background-color: white
        }

        th.style0 {
            vertical-align: bottom;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 11pt;
            background-color: white
        }

        td.style1 {
            vertical-align: bottom;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 11pt;
            background-color: white
        }

        th.style1 {
            vertical-align: bottom;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 11pt;
            background-color: white
        }

        td.style2 {
            vertical-align: right;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 32px;
            background-color: white;
            white-space: nowrap;
        }

        th.style2 {
            vertical-align: right;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 48pt;
            background-color: white;
            white-space: nowrap;
        }

        td.style3 {
            vertical-align: top;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 24px;
            background-color: white;
            white-space: nowrap;
            padding-top: 0;
            padding-bottom: 0;
           
            margin: 0;
        }

        th.style3 {
            vertical-align: top;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 30px;
            background-color: white;
            padding-top: 0;
            padding-bottom: 0;
            margin: 0;
        }

        td.style4 {
            vertical-align: right;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 26pt;
            background-color: white
        }

        th.style4 {
            vertical-align: right;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 26pt;
            background-color: white
        }

        td.style5 {
            vertical-align: middle;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 42pt;
            background-color: white;
            white-space: nowrap
        }

        th.style5 {
            vertical-align: middle;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 42pt;
            background-color: white
        }

        td.style6 {
            vertical-align: top;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        th.style6 {
            vertical-align: left;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 50pt;
            background-color: white
        }

        td.style7 {
            vertical-align: right;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        th.style7 {
            vertical-align: right;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        td.style8 {
            vertical-align: middle;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 24pt;
            background-color: white
        }

        th.style8 {
            vertical-align: middle;
            text-align: right;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 24pt;
            background-color: white
        }

        td.style9 {
            vertical-align: top;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 22pt;
            background-color: white
        }

        th.style9 {
            vertical-align: top;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 22pt;
            background-color: white
        }

        td.style10 {
            vertical-align: top;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        th.style10 {
            vertical-align: top;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        td.style11 {
            vertical-align: right;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 75pt;
            background-color: white
        }

        th.style11 {
            vertical-align: right;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 75pt;
            background-color: white
        }

        td.style12 {
            vertical-align: right;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        th.style12 {
            vertical-align: right;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        td.style13 {
            vertical-align: top;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        th.style13 {
            vertical-align: top;
            text-align: right;
            padding-right: 0px;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            font-weight: bold;
            color: #000000;
            font-family: 'David';
            font-size: 28pt;
            background-color: white
        }

        td.style14 {
            vertical-align: middle;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 26pt;
            background-color: white
        }

        th.style14 {
            vertical-align: middle;
            text-align: center;
            border-bottom: none #000000;
            border-top: none #000000;
            border-left: none #000000;
            border-right: none #000000;
            color: #000000;
            font-family: 'David';
            font-size: 26pt;
            background-color: white
        }

        table.sheet0 col.col0 {
            width: 42pt
        }

        table.sheet0 col.col1 {
            width: 129.45555407pt
        }

        table.sheet0 col.col2 {
            width: 82.68888794pt
        }

        table.sheet0 col.col3 {
            width: 136.23333177pt
        }

        table.sheet0 col.col4 {
            width: 437.16666165pt
        }

        table.sheet0 col.col5 {
            width: 42pt
        }

        table.sheet0 col.col6 {
            width: 42pt
        }

        table.sheet0 col.col7 {
            width: 42pt
        }

        table.sheet0 tr {
            height: 12pt
        }

        table.sheet0 tr.row0 {
            height: 20pt
        }

        table.sheet0 tr.row1 {
            height: 45px
        }

        table.sheet0 tr.row2 {
            height: 34px
        }

        table.sheet0 tr.row3 {
            height: 38pt
        }

        table.sheet0 tr.row4 {
            height: 42px
        }

        table.sheet0 tr.row5 {
            height: 45pt
        }

        table.sheet0 tr.row6 {
            height: 35pt
        }

        table.sheet0 tr.row7 {
            height: 35pt
        }

        table.sheet0 tr.row8 {
            height: 45pt
        }

        table.sheet0 tr.row9 {
            height: 45pt
        }

        table.sheet0 tr.row10 {
            height: 45pt
        }

        table.sheet0 tr.row11 {
            height: 90pt
        }

        table.sheet0 tr.row12 {
            height: 45pt
        }

        table.sheet0 tr.row13 {
            height: 38pt
        }

        table.sheet0 tr.row14 {
            height: 70pt
        }

        table.sheet0 tr.row15 {
            height: 45pt
        }

        table.sheet0 tr.row16 {
            height: 35pt
        }

        table.sheet0 tr.row17 {
            height: 35pt
        }

        table.sheet0 tr.row18 {
            height: 55pt
        }

        table.sheet0 tr.row19 {
            height: 63pt
        }

        table.sheet0 tr.row20 {
            height: 58pt
        }

        /* Page break control - 2 flyers per page */
        table.sheet0 {
            page-break-after: always;
            page-break-inside: avoid;
        }
        
        /* Remove page break from last page to avoid empty page */
        table.sheet0.no-page-break {
            page-break-after: auto !important;
        }
        
        @media print {
            /* Ensure last table doesn't create empty page - use multiple approaches */
            table.sheet0.no-page-break {
                page-break-after: auto !important;
                page-break-before: auto !important;
                break-after: auto !important;
            }
            
            /* Remove any trailing content that might cause empty page */
            #content {
                margin: 0 !important;
                padding: 0 !important;
            }
            
            #content > table:last-child,
            #content > table.sheet0:last-child {
                page-break-after: auto !important;
                break-after: auto !important;
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
            }
            
            /* Prevent body from adding extra space */
            body {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
            }
            
            /* Reduce any default bottom spacing to minimum */
            html {
                padding: 0 !important;
                margin: 0 !important;
            }
            
            #content {
                padding: 0 !important;
                margin: 0 !important;
            }
            
            /* Remove bottom spacing from last table and rows */
            table.sheet0:last-child {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
            }
            
            table.sheet0:last-child tr:last-child {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
                height: auto !important;
            }
            
            table.sheet0:last-child tr:last-child td {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
            }
            
            /* Reduce height of last row in last table to minimize bottom space */
            table.sheet0:last-child tr.row20 {
                height: 0pt !important;
                min-height: 0 !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            table.sheet0:last-child tr.row20 td {
                height: 0 !important;
                min-height: 0 !important;
                margin: 0 !important;
                padding: 0 !important;
                line-height: 0 !important;
            }
            
            /* Ensure no orphaned content */
            #content::after {
                content: '';
                display: none;
            }
        }

        /* Screen controls */
        .controls {
            background: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .controls button {
            padding: 12px 30px;
            font-size: 18px;
            margin: 0 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-print {
            background: #4CAF50;
            color: white;
        }

        .btn-print:hover {
            background: #45a049;
        }

        .btn-back {
            background: #2196F3;
            color: white;
        }

        .btn-back:hover {
            background: #0b7dda;
        }

        @media print {
            .controls {
                display: none;
            }
        }

 
        tr.row3 .style4 {
            font-size: 37px !important
        }

        /* Remove padding to fit 2 institutes per page */
        td.column1,
        th.column1 {
            padding-right: 0px !important;
        }
        tr.row1 td.column1 {
            padding-right: 0px !important;
        }
        
        /* Remove all padding from table cells */
        table.sheet0 td,
        table.sheet0 th {
            padding: 0 !important;
        }
    </style>
</head>

<body>
    <style>
        @page {
            margin-left: 0in;
            margin-right: 0in;
            margin-top: 0in;
            margin-bottom: 0in;
            size: A4;
            padding: 0in;
        }
        
        @page :last {
            margin: 0in;
            padding: 0in;
        }

        body {
            margin-left: 0in;
            margin-right: 0in;
            margin-top: 0in;
            margin-bottom: 0in;
        }
    </style>

    <div class="controls">
        <button class="btn-print" onclick="saveToPDF()">ğŸ’¾ ×©××•×¨ ×›-PDF</button>
        <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ ×”×“×¤×¡</button>
        <button class="btn-back" onclick="goBack()">â† ×—×–×•×¨</button>
        <span id="counter" style="margin-right: 20px; font-size: 18px; font-weight: bold;"></span>
    </div>

    <div id="content"></div>

    <script>
        window.onload = function () {
            const selectedData = JSON.parse(localStorage.getItem('selectedForPrint') || '[]');

            if (selectedData.length === 0) {
                document.getElementById('content').innerHTML = '<div style="text-align:center;padding:50px;font-size:18px;">××™×Ÿ × ×ª×•× ×™× ×œ×”×“×¤×¡×”</div>';
                return;
            }

            document.getElementById('counter').textContent = `${selectedData.length} ××•×¡×“×•×ª`;

            // Group institutes 2 per page
            const pages = [];
            for (let i = 0; i < selectedData.length; i += 2) {
                pages.push(selectedData.slice(i, i + 2));
            }

            // Generate HTML for each page
            let html = '';
            pages.forEach((pageData, index) => {
                const isLastPage = index === pages.length - 1;
                html += generatePage(pageData, isLastPage);
            });

            document.getElementById('content').innerHTML = html;
            
            // Ensure last table has no-page-break class and remove any trailing content
            setTimeout(() => {
                const contentDiv = document.getElementById('content');
                const tables = contentDiv.querySelectorAll('table.sheet0');
                if (tables.length > 0) {
                    const lastTable = tables[tables.length - 1];
                    lastTable.classList.add('no-page-break');
                    // Remove any whitespace or content after last table
                    let node = lastTable.nextSibling;
                    while (node) {
                        const next = node.nextSibling;
                        if (node.nodeType === Node.TEXT_NODE) {
                            if (node.textContent.trim() === '') {
                                node.remove();
                            }
                        } else if (node.nodeType === Node.ELEMENT_NODE) {
                            node.remove();
                        }
                        node = next;
                    }
                }
            }, 0);
        };

        function generatePage(institutes, isLastPage = false) {
            // One table = one A4 page with 2 flyers (like desktop app)
            const pageBreakClass = isLastPage ? 'sheet0 gridlines no-page-break' : 'sheet0 gridlines';
            let html = `<table border="0" cellpadding="0" cellspacing="0" class="${pageBreakClass}">`;
            html += '<col class="col0"><col class="col1"><col class="col2"><col class="col3"><col class="col4"><col class="col5"><col class="col6"><col class="col7">';
            html += '<tbody>';

            // First flyer (always exists)
            if (institutes[0]) {
                html += generateFlyerRows(institutes[0]);
            }

            // Second flyer (if exists - for odd numbers, last page has only 1)
            if (institutes[1]) {
                html += generateFlyerRows(institutes[1]);
            }

            html += '</tbody></table>';
            return html;
        }

        function generateFlyerRows(inst) {
            return `
          <tr class="row0">
            <td class="column0">&nbsp;</td>
            <td class="column1">&nbsp;</td>
            <td class="column2">&nbsp;</td>
            <td class="column3">&nbsp;</td>
            <td class="column4">&nbsp;</td>
            <td class="column5">&nbsp;</td>
            <td class="column6">&nbsp;</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row1">
            <td class="column0">&nbsp;</td>
            <td class="column1 style3 s style2" colspan="4"><span style="font-weight:bold; color:#C00000; font-family:'David'; font-size:37px">×§×™×™×˜×¨×™× ×’:</span>
                <span style="font-weight:bold; color:#002060; font-family:'David'; font-size:37px">&quot;×™×©×™×‘×ª ×××™×¨ ×‘×ª ×¢×™×Ÿ&quot;    </span>
                <span style="font-weight:bold; color:#000000; font-family:'David'; font-size:37px">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;                  ×˜×‘×¨×™×”</span></td>
            <td class="column5">&nbsp;</td>
            <td class="column6">&nbsp;</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row2">
            <td class="column0">&nbsp;</td>
            <td class="column1 style3 s"  style="font-family:'David';  font-size:29px">×¡××œ ××•×¡×“:</td>
            <td class="column2 style3 n" style="font-family:'David';  font-size:29px">${inst.inst_id || ''}</td>
            <td class="column3 style3 s" style="font-family:'David';  font-size:29px">×˜×œ ××•×§×“:</td>
            <td class="column4 style3 s" style="font-family:'David';  font-size:29px">0732088557</td>
            <td class="column5">&nbsp;</td>
            <td class="column6">&nbsp;</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row3">
            <td class="column0">&nbsp;</td>
            <td class="column1 style3 s" style="font-family:'David';  font-size:29px">×›×ª×•×‘×ª:</td>
            <td class="column2 style3 s" style="font-family:'David';  font-size:29px">${(inst.address || '').substring(0, 9)}</td>
            <td class="column3 style3 s" style="font-family:'David';  font-size:29px">&nbsp;×§×‘×•×¦×ª ×’×™×œ:</td>
            <td class="column4 style3 s" style="font-family:'David';  font-size:29px">&nbsp;${inst.age_group || ''}</td>
            <td class="column5">&nbsp;</td>
            <td class="column6">&nbsp;</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row4">
            <td class="column0">&nbsp;</td>
            <td class="column1 style5 s" style="font-family:'David'; font-size:37px; ${inst.allergens > 0 ? 'color: #980000;' : ''}">×©× ××•×¡×“:</td>
            <td class="column2 style5 s style5" colspan="2" style="font-size:45px;font-weight:bold; overflow:visible; white-space:nowrap;">${(inst.name || '').substring(0, 15)}</td>
            <td class="column4" rowspan="7"  style="position:relative; padding:0; width:220px; min-width:220px; max-width:220px; vertical-align:top; overflow:visible;">
              <div style="position:relative; width:220px; height:240px; margin:0; padding:10; overflow:visible;">
                <img src="${inst.image_url || 'Picture1.png'}" alt="×ª××•× ×”" style="position:absolute; top:-30px; left:-60px; width:200px; height:240px; object-fit:contain; display:block; margin:0;">
              </div>
            </td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row5">
            <td class="column0">&nbsp;</td>
            <td class="column1 style8 s" style="font-size:37px; ${inst.allergens > 0 ? 'color: #980000;' : ''}">×¡×•×’:</td>
            <td class="column2 style8 s style7" colspan="2" style="font-size:37px; font-weight:bold; ${inst.allergens > 0 ? 'color: #980000;' : ''}">${inst.serving_type || ''}</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row6">
            <td class="column0">&nbsp;</td>
            <td class="column1 style8 s" style="font-size:37px; ${inst.allergens > 0 ? 'color: #980000;' : ''}">××œ×¨×’× ×™:</td>
            <td class="column2 style8 s" style="font-size:37px; font-weight:bold; ${inst.allergens > 0 ? 'color: #980000;' : ''}">${inst.allergens || '0'}</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row7">
            <td class="column0">&nbsp;</td>
            <td class="column1 style3 s" style="font-size:37px; ${inst.allergens > 0 ? 'color: #980000;' : ''}" colspan="2">×›××•×ª ×× ×•×ª:</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row8">
            <td class="column0">&nbsp;</td>
            <td class="column1 style11 s style11" rowspan="2" style="font-size:59px">${inst.quantity || ''}</td>
            <td class="column2 style12 s style12" colspan="2" style="font-size:35px">${inst.dish1 || ''}</td>
            <td class="column4 style13 null"></td>
            <td class="column5">&nbsp;</td>
            <td class="column6">&nbsp;</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row9">
            <td class="column0">&nbsp;</td>
            <td class="column2 style12 s style12" colspan="2" style="font-size:35px">${inst.dish2 || ''}</td>
            <td class="column4 style13 null"></td>
            <td class="column5">&nbsp;</td>
            <td class="column6">&nbsp;</td>
            <td class="column7">&nbsp;</td>
          </tr>
          <tr class="row10">
            <td class="column0">&nbsp;</td>
            <td class="column1 style14 s" style="font-size:30px; font-weight:bold;">${inst.date || ''}</td>
            <td class="column2 style12 s style12" colspan="2" style="font-size:35px">${inst.dish3 || ''}</td>
            <td class="column4 style13 null"></td>
            <td class="column5">&nbsp;</td>
            <td class="column6">&nbsp;</td>
            <td class="column7">&nbsp;</td>
          </tr>
        `;
        }

        function saveToPDF() {
            // Generate filename with date
            const now = new Date();
            const dateStr = now.toISOString().split('T')[0]; // YYYY-MM-DD
            const filename = `flyers_${dateStr}.pdf`;

            // Trigger browser's print dialog with PDF as default
            // User will need to select "Save as PDF" or "Microsoft Print to PDF"
            const printWindow = window.open('', '_blank');
            if (printWindow) {
                printWindow.document.write(document.documentElement.outerHTML);
                printWindow.document.close();
                setTimeout(() => {
                    printWindow.print();
                }, 500);
            } else {
                // If popup blocked, use current window
                window.print();
            }
        }

        function goBack() {
            // Try to close the window if opened as popup
            if (window.opener) {
                window.close();
            } else {
                // Otherwise navigate back or to main page
                if (document.referrer) {
                    window.history.back();
                } else {
                    window.location.href = 'manage_institutes.html';
                }
            }
        }
    </script>

</body>

</html>